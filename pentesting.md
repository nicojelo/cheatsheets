## Reconaissance---------------------------------------------

##### nmap scanning

```bash
nmap -Pn -p- -T4 {ip}
nmap -A -p<ports> -T4 {ip}
```

##### directory enumeration
```bash
gobuster dir -u {ip} -w {path_wordlist} -t {no. threads} -x {strings, pdf, php, txt, etc.}
dirbuster #opens dirbuster window
```

##### checking for sql injections
```bash
sqlmap -u {weburl, http://10.10.60.252/administrator.php>} --forms --dump --dbms=mysql
sqlmap --tables -T users --dump
```

##### enum4linux (if may samba port open)
```bash
enum4linux -a <MACHINE IP>
```

## Foothold---------------------------------------------

##### connecting ssh
```bash
ssh {user}@{ip} -p {port} 
```

##### putting files in the target system
```bash
scp {path to linenum} {user}@{host}:{path} #Example: scp /opt/LinEnum.sh pingu@10.10.10.10:/tmp
```



## Foothold Enumeration---------------------------------------------

###### getting an interactive shell
```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```
```bash
SHELL=/bin/bash script -q /dev/null
Ctrl-Z
stty raw -echo
fg
reset
xterm
```
##### basic enumeration after foothold

Linux
```bash
	whoami
    id
    ifconfig/ip addr
    uname -a
    ps -ef
```

Windows
```bash
    whoami
    ver
    ipconfig
    tasklist
    netstat -an
```

LinEnum

##### check files of user (and group) you landed on

```bash
find / -type f {-group/-user} {group/user} 2>/dev/null
ls -la /
```

##### check console history

```bash
cat ~/.*history | less
type C:\Users\{user}\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
```

##### if from www-data, check db credentials
```bash
cat /var/www/html/cdn-cgi/login/db.php
```

##### check sudo-able commands
```bash
sudo -l
```
##### check root processes
```bash
find / -perm +6000 2>/dev/null | grep '/bin/'
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \; 2> /dev/null
```

###### pivoting to other users (if you have password)
```bash
su {user name}
```



## Privelege Escalation ---------------------------------------------

##### Weak file permissions
if /etc/shadow is readable -> crack hash (use john)
if /etc/shadow is writable -> rewrite hash (use john)
if /etc/passwd is writable -> add password (use openssl passwd)

##### Poisoning Cron jobs

##### adding PATH (for creating malicious programs)
```bash
export PATH={/tmp}:$PATH
```

##### Mysl UDF priv esc (if mysql is running on root)
https://www.exploit-db.com/exploits/1518

##### Kernel Exploits
perl /home/user/tools/kernel-exploits/linux-exploit-suggester-2/linux-exploit-suggester-2.pl

## Misc

##### use gdb in checking binary files
##### pwn command for overflow

##### in cracking hashes
```bash
hashcat -m {hash algo mode} {hash file path} {wordlist path}
```
https://hashcat.net/wiki/doku.php?id=example_hashes

##### in cracking ssh passkeys (given public and private keys)
```bash
python ssh2john.py id_rsa > id_rsa.hash
john id_rsa.hash -wordlist=rockyou.txt
```
https://www.abhizer.com/crack-ssh-with-john/

##### chmod permissions
1 - execute
2 - write
4 - read

## References

##### Root Reverse Shell Cheat sheet
http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
##### Linux Privelege Escalation checker
https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS
##### Shell esscape sequences
https://gtfobins.github.io/
##### Encoder/Decoder
https://gchq.github.io/CyberChef/